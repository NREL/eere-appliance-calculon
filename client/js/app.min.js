/*!
 * Project: eere-appliance-calculon
 * Version: 1.0.0
 * Author: Michael Oakley <michael.oakley@nrel.gov>
 * Build Date: 12-04-2016
 */

"use strict";$(document).ready(function(){function a(){var a=$(this).css("height");return'<div style="height: '+a+'" class="fouc-placeholder"></div>'}var b={url:"//api.eia.gov/series/",api_key:"4A8DA35AF7501244A974E9603C4FF11B",series_id:"ELEC.PRICE.XX-RES.Q"},c=$(".form-control"),d=$(".input-group"),e=$("#appliances"),f=$("#watts"),g=$("#hours"),h=$("#days"),i=$("#states"),j=$("#energy"),k=$("#cost"),l=$(".integer-input"),m=$("#appliance-template").html(),n=Handlebars.compile(m),o=n(JSON.parse($("#appliance-data").html()));e.append(o),e.wrap(a()),e.addClass("selectpicker"),e.removeClass("invisible");var p=$("#state-template").html(),q=Handlebars.compile(p),r=q(JSON.parse($("#state-data").html()));i.append(r),i.wrap(a),i.addClass("selectpicker"),i.removeClass("invisible");var s=function(a){d.removeClass("active"),a.addClass("active")},t=function(){var a=this,b=f.val(),d=h.val(),l=i.val(),m=0,n=0,o=g.val(),p=!1,q=void 0;c.each(function(b,c){return p=$(a).val()?!0:!1}),p&&(q=e.find("option:selected"),"Refrigerator"===q.text()&&(o=Math.round(o/3)),m=b*o*d/1e3,n=Math.round(m*l)/100,j.html(m+" kWh"),k.html("$"+n.toFixed(2)))},u=function(a){var c=b.series_id.replace("XX",a);return $.ajax({type:"GET",dataType:"json",url:b.url,data:{api_key:b.api_key,series_id:c}})};l.on("change",function(a){return a.currentTarget.value=Math.round(a.currentTarget.value)});var v=function(a,b){i.find("option:eq("+b+")").data("subtext","$0."+a+"/kWh"),i.selectpicker("refresh")};i.on("change",function(a){var b=a.currentTarget,c=b.selectedIndex,d=b[c],e=d.dataset.stateCode,f=new $.Deferred,g=void 0;d.value?(g=d.value,v(g,c)):(f=u(e),f.done(function(a){g=Math.round(a.series[0].data[0][1]),d.value=g,v(g,c),t()}),f.fail(function(){return alert("Error fetching rate data")}))}),$("#appliances").on("change",function(a){return f.val(a.currentTarget.value)}),$("#app").on("change",".form-control",t),$("#app").on("focus",".form-control",function(a){var b=$(a.currentTarget).parents(".input-group");s(b)})});
//# sourceMappingURL=app.js.map